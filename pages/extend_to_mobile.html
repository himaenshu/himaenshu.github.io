<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="../stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="../stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Technical Mirage by himaenshu</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Technical Mirage</h1>
        </header>

        <!--section id="downloads" class="clearfix">
          <a href="https://github.com/himaenshu" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section-->
        
        <span >
          <a href="https://github.com/himaenshu"><img src="https://avatars1.githubusercontent.com/u/125638?s=60" width="42" height="42" style="float:left;"/></a>&nbsp;&nbsp;<a href="https://github.com/himaenshu">himaenshu</a>
          </br>&nbsp;&nbsp;<span style="font-size:12px;">June, 2012</span>
        </span>

        <hr>

        <section id="main_content">
          <h3>
<a name="how-to-extend-ruby-on-rails-web-application-to-mobile-browser" class="anchor" href="#how-to-extend-ruby-on-rails-web-application-to-mobile-browser"><span class="octicon octicon-link"></span></a>Extending Ruby on Rails webapp to mobile browsers</h3>

<p>The proposed architecture is only relevant to a Ruby on Rails web application to be extended to mobile web browsers. This approach is focused on having different HTML views for different mobile and includes code snippets to override the default template behavior.</p>

<div><img src="resources/MobileWebAppArchitectureDiagram.PNG" alt="Mobile WebApp Architecture Diagram"/></div>
<p>&nbsp;</p>

<ol>
<li><p>Create a MobileController class and all mobile specific controllers should inherit this class.</p></li>
<li><p>Use "mobile" as a namespace for controllers, views and helpers</p></li>
<li><p>Use additional namespace in parallel to "mobile" to define templates for blackberry (as "bb") and iphone (as "iphone")  </p></li>
<li>Create a module in library file (say /lib/mobile_behavior.rb) and define below methods in it to identify user agent from request and to define layout based on device:</li>
<pre><code>
def blackberry?
  request.user_agent =~ /BlackBerry/
end

def iphone?
  request.user_agent =~ /iPhone/
end

def mobile_layout
  if blackberry?
    "blackberry"
  elsif iphone?
    "iphone"
  else
    "mobile"
  end
end
</code></pre>

<li>Add below method definition to library file (mobile_behavior.rb) to override the default method and specify default template based on device:</li>
<pre><code>
def default_template_name(action_name = self.action_name)
  if action_name
    action_name = action_name.to_s
    if action_name.include?('/') && template_path_includes_controller?(action_name)
      action_name = strip_out_controller(action_name)
    end
  end
  if blackberry?
    iphone_controller_path = self.controller_path.gsub(“/mobile/", “/iphone/")
    "#{iphone_controller_path}/#{action_name}"
  elsif blackberry?
    bb_controller_path = self.controller_path.gsub(“/mobile/", “/bb/")
    "#{bb_controller_path}/#{action_name}"
  else
    "#{self.controller_path}/#{action_name}"
  end
end
</code></pre>

<li>Include library file module in MobileController:</li>
<pre><code>include  MobileBehavior</code></pre>

<li>Call layout in MobileController:</li>
<pre><code>layout :mobile_layout</code></pre>

<li><p>Create different layout templates as blackberry, iphone and others (mobile) in /app/views/layouts.</p></li>
<li><p>Write the common Controllers and Helpers for all mobile platforms.</p></li>
<li>Create different view templates matching the actions for each mobile platform in the below structure:</li>
<pre><code>
/app/views/bb/&lt;namespace-mapping-controller&gt;/&lt;template-mapping-action&gt;
/app/views/iphone/&lt;namespace-mapping-controller&gt;/&lt;template-mapping-action&gt;
</code></pre>

<p>We are done.  </p>

        </section>

        <footer>
          <span>This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
        </footer>

        
      </div>
    </div>
  </body>
</html>